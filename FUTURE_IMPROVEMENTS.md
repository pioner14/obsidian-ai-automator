## Будущие улучшения и оптимизации проекта "Obsidian AI Automator"

Этот документ описывает потенциальные улучшения и оптимизации для проекта, направленные на повышение эффективности, надежности и удобства использования, при этом стараясь не усложнять архитектуру чрезмерно.

### 1. Оптимизация механизма мониторинга папки (inotify)

**Текущая проблема:** Текущий механизм мониторинга папки `WATCH_DIR` основан на периодическом опросе с помощью команды `find`. Это может быть неэффективно и ресурсоемко для больших директорий или при очень частых интервалах опроса, так как ЦП и диск постоянно активируются.

**Предлагаемое улучшение:** Заменить механизм опроса на событийно-ориентированный подход с использованием `inotify` (встроенного в ядро Linux).

*   **Реализация:** Создать отдельный Python-скрипт, использующий библиотеку `watchdog` (или аналогичную), которая предоставляет удобный интерфейс для `inotify`. Этот скрипт будет "слушать" события файловой системы (например, создание нового файла) в `WATCH_DIR`.
*   **Преимущества:**
    *   **Эффективность:** Значительно снижает потребление системных ресурсов (ЦП, диск, энергопотребление), так как скрипт "спит" до тех пор, пока не произойдет реальное изменение.
    *   **Мгновенная реакция:** Обработка файлов начинается практически сразу после их появления, без задержки, связанной с интервалом опроса.
*   **Интеграция:** `watch_and_transcribe.sh` будет запускать этот Python-скрипт мониторинга, который, в свою очередь, будет вызывать `obsidian-ai-transcribe.sh` при обнаружении нового файла.

### 2. Улучшенная обработка ошибок и уведомления

**Текущая проблема:** Ошибки в процессе транскрибации или анализа LLM записываются в логи, но нет активного механизма уведомления пользователя.

**Предлагаемое улучшение:** Внедрить систему уведомлений о критических ошибках.

*   **Реализация:**
    *   Интегрировать отправку уведомлений (например, по электронной почте, через Telegram-бота или push-уведомления) при возникновении ошибок в `ai_analyzer.py` (например, проблемы с API-ключами, сбои Deepgram/NVIDIA API, пустой транскрипт).
    *   Добавить более детальную информацию об ошибке в уведомление.
*   **Преимущества:** Пользователь будет оперативно информирован о проблемах, требующих внимания, что повысит надежность рабочего процесса.

### 3. Централизованное управление конфигурацией

**Текущая проблема:** Некоторые параметры конфигурации (например, `OBSIDIAN_VAULT_PATH`, `NVIDIA_MODEL`) жестко закодированы в скриптах или разбросаны по разным файлам.

**Предлагаемое улучшение:** Объединить все настраиваемые параметры в одном централизованном файле конфигурации.

*   **Реализация:** Использовать файл `config.ini` (с библиотекой `configparser` в Python) или `config.json` для хранения всех настроек. Скрипты будут считывать параметры из этого файла.
*   **Преимущества:** Упрощает управление конфигурацией, делает проект более гибким и легким для настройки без изменения кода.

### 4. Более надежная фильтрация типов файлов

**Текущая проблема:** Текущая фильтрация по MIME-типу может быть не всегда точной или достаточной.

**Предлагаемое улучшение:** Расширить и сделать более гибкой логику определения и фильтрации файлов.

*   **Реализация:**
    *   Добавить возможность настройки списка разрешенных расширений файлов (например, `.mp4`, `.mov`, `.mkv`, `.mp3`, `.wav`) в файле конфигурации.
    *   Использовать более надежные методы определения типа файла, если `file --mime-type` окажется недостаточным.
*   **Преимущества:** Предотвращает попытки обработки неподдерживаемых файлов и дает пользователю больше контроля.

### 5. Параллельная обработка файлов

**Текущая проблема:** Скрипт обрабатывает файлы последовательно, один за другим.

**Предлагаемое улучшение:** Внедрить параллельную обработку для нескольких файлов, обнаруженных в `WATCH_DIR`.

*   **Реализация:**
    *   В `watch_and_transcribe.sh` использовать `xargs -P N` (где N — количество параллельных процессов) для запуска `obsidian-ai-transcribe.sh` для нескольких файлов одновременно.
    *   В Python-скрипте мониторинга (если он будет реализован) использовать `multiprocessing.Pool` для параллельного вызова `obsidian-ai-transcribe.sh`.
*   **Преимущества:** Значительно ускоряет обработку, если в директории появляется несколько файлов одновременно.
